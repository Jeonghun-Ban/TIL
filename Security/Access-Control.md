접근 통제(Access Control)
===

허가되지 않은 자원의 사용과 허가되지 않은 방법을 통한 자원 사용을 제어하는 것

Contents
---

- [절차](#절차)
- [사용자 인증](#사용자-인증)
  - [지식 기반 인증](#지식-기반-인증)
    - [패스워드](#패스워드)
    - [시도-응답 개인 식별 프로토콜](#시도-응답-개인-식별-프로토콜)
    - [영지식 개인 식별 프로토콜](#영지식-개인-식별-프로토콜)
    - [I-PIN(Internet Personal Identification Number)](#i-pininternet-personal-identification-number)
  - [소유 기반 인증](#소유-기반-인증)
    - [메모리 카드](#메모리-카드)
    - [스마트 카드](#스마트-카드)
    - [일회용 패스워드(OTP, One-Time Password)](#일회용-패스워드otp-one-time-password)
  - [개체 특성 기반 인증](#개체-특성-기반-인증)
    - [생체 인증](#생체-인증)
  - [통합인증체계(SSO)](#통합인증체계sso)
    - [엑스트라넷 접근 관리(EAM, Extranet Access Management)](#엑스트라넷-접근-관리eam-extranet-access-management))
    - [식별/접근 관리(IAM, Identity and Access Management)](#식별접근-관리iam-identity-and-access-management))
  - [커버로스(Kerberos)](#커버로스kerberos)
    - [구성 요소](#구성-요소)
    - [구성도](#구성도)
    - [취약점](#취약점)
    - [V4 vs V5](#v4-vs-v5)
  - [세사미(SESAME)](#세사미sesame)
- [보안 모델](#보안-모델)
  - [강제적 접근통제(MAC, Mandatory Access Control)](#강제적-접근통제mac-mandatory-access-control))
    - [벨라파듈라 모델(BLP, Bell-LaPadula Confidentiality Model)](#벨라파듈라-모델blp-bell-lapadula-confidentiality-model)
    - [비바 무결성 모델(Biba Integrity Model)](#비바-무결성-모델biba-integrity-model)
    - [클락-윌슨 무결성 모델(Clark-Wilson Integrity Model)](#클락-윌슨-무결성-모델clark-wilson-integrity-model)
    - [만리장성 모델(Chinese Wall Model)](#만리장성-모델chinese-wall-model))
  - [임의적 접근통제(DAC, Discretionary Access Control)](#임의적-접근통제-dacdiscretionary-access-control))
    - [접근 제어 행렬(Access Control Matrix)](#접근-제어-행렬access-control-matrix)
    - [자격 목록(Capability List, Capability Tickets)](#자격-목록capability-list-capability-tickets))
    - [접근제어 목록(ACLs, Access Control Lists)](#접근제어-목록acls-access-control-lists))
  - [역할기반 접근통제(RBAC, Role-Based Access Control)](#역할기반-접근통제rbac-role-based-access-control))
- [접근통제 보안위협 및 대응책](#접근통제-보안위협-및-대응책)
  - [패스워드 크래커](#패스워드-크래커)
  - [사회공학 공격](#사회공학-공격)

절차
---

접근통제 3단계에 덛붙여 책임 추적성(부인 방지) 단계가 존재

- 식별
  - 본인이 누구라는 것을 시스템에 밝히는 행위
  - ID, 계정번호, 메모리카드
- 인증
  - 주체의 신원을 검증하기 위한 증명
  - 패스워드, 스마트카드, 생채인증
- 인가
  - 인증된 주체에게 접근을 허용하고 특정 업무를 수행할 권리를 부여
  - 접근제어목록, 보안등급
- 책임추적성
  - 시스템에 인가된 주체가 시스템에 어떤 행위를 하고 있는지 기록

사용자 인증
---

### 지식 기반 인증

사용자가 알고 있는 것에 의존하는 방법

- 장점
  - 다양한 분야에서 사용 가능
  - 검증이 확실
  - 관리 비용 저렴
- 단점
  - 소유자의 분실 가능성
  - 공격자의 추측 가능
  - 사회 공학적 공격에 취약(피싱)

#### 패스워드

가장 간단하면서 오랫동안 사용된 개체인증 방식

- 고정된 패스워드
  - 접속시 반복해서 사용
  - 방법
    1. ID/PW를 테이블로 정렬 저장
    2. PW를 해시한 값으로 저장
    3. PW에 솔트(Salt)를 붙여 해시한 값을 저장
- 일회용 패스워드(OTP, One-Time Password)
  - 동적 패스워드, 인증시 한번 유효
  - 사용자와 시스템이 PW 목록에 대해 합의하고, 오직 한번만 사용
  - 사용자와 시스템이 PW를 순차적으로 업데이트하기로 합의
  - 사용자와 시스템이 해시함수를 이용하여 순차적으로 업데이트하기로 합의

#### 시도-응답 개인 식별 프로토콜

대칭형 암호와 공개키 암호에 기반하여 도청이 가능한 환경에서 안전

- 일방향 개인 식별 프로토콜
  - 서버 또는 클라이언트 중에 어느 한 대상을 식별하는 프로토콜
- 상호 개인 식별 프로토콜
  - 상호간에 대상을 식별하는 프로토콜

#### 영지식 개인 식별 프로토콜

자신의 비밀정보를 제공하지 않고 자신의 정당한 신분만을 밝힘으로써 식별되는 유형의 프로토콜

- 스마트카드, 원격지 로그인 시 사용자 식별

#### I-PIN(Internet Personal Identification Number)

주민번호 대신에 ID와 PW로 대체하는 수단

- 이용효과
  - 주민번호 유출예방 
  - 본인확인 강화

### 소유 기반 인증

실생활에서 사용되는 다양한 매체를 이용하여 사용자 인증을 수행

- 장점
  - 신용카드 등 다양한 수단이 사용될 수 있음
  - 입증된 기술(신용카드)
  - 생체 인증보다 경제적
- 단점
  - 소유물이 없을 경우 인증이 어려움
  - 복제 가능
  - 자산 관리 기능 요구

#### 메모리 카드

- 정보를 저장할 수 있지만 정보를 처리할 수 없다.

#### 스마트 카드

- 정보 저장/처리 가능
- 접촉식과 비 접촉식으로 나뉨

#### 일회용 패스워드(OTP, One-Time Password)

OTP용 프로그램에서 사용자 패스워드와 OTP 생성용 입력 값을 입력하면 암호 알고리즘을 사용해서 OTP를 생성하는 사용자
인증 방법.

- 질의응답 방식
  - 시도-응답 방식
  - 구조가 간단하며 OTP 생성 매체와 인증서버 간 동기화가 필요 없음
  - 사용자가 질의 값을 직접 입력해야 하고, 같은 질의 값이 생성되지 않도록 인증 서버 관리가 필요
- 시간과 이벤트 동기화 방식
  - 토큰장치와 인증서비스는 반드시 동일한 비밀키를 공유하여 암∙복호화에 사용
  - 시간 동기화 방식
    - 토큰장치와 비밀키에 나타나는 시간 값은 OTP를 생성하는데 사용
    - OTP 생성 매체와 인증서버의 시간 정보이 동기화되어 있어야 함
  - 이벤트 동기화 방식
    - 사용자가 토큰장치의 버튼을 누르면 다음 인증 값이 나타남
    - OTP 생성 매체와 인증서버의 계수기 값이 동기화되어 있어야 함
- S/KEY 방식
  - 유닉스 계열 OS에서 인증에 사용되는 해시 체인 기반의 방식
  - 동작방식
    - 클라이언트에서 임의의 비밀키를 서버에 전송
    - 이 비밀키를 첫 번째 값으로 해시 체인 방식으로 이전 결과값에 대한 해시 값을 구하는 작업을 n번 수행
    - n개의 OTP를 서버에 저장

### 개체 특성 기반 인증

- 장점
  - 사용하기 쉬움
  - 분실, 손실, 도난 X
  - 위조가 어려움
- 단점
  - 잘못 판단할 가능성
  - 관리가 어려움
  - 인증을 위한 임계치 설정의 어려움

#### 생체인증

생체적 혹은 행동적 특성을 측정하여 신원을 확인하는 방법

- 기술 평가항목
  - 보편성, 유일성, 지속성, 획득성, 성능, 수용성, 반기만성
- 정확도
  - FRR(False Rejection Rate, 오거부율)
    - 인식되어야 할 사람이 얼마나 시스템에 의해서 인식이 되지 않았는지에 대한 값
  - FAR(False Acceptance Rate, 오인식률)
    - 인식되어서는 안 될 사람이 얼마나 시스템에 의해서 인식이 되는지에 대한 값
  - CER(Crossover Error Rate)/EER(Equal Error Rate)
    - FRR과 FAR이 일치하는 지점
    - 수치가 낮을수록 정확

### 통합인증체계(SSO)

한 번의 시스템 인증을 통하여 접근하고자 하는 다양한 시스템에 재인증 절차 없이 접근할 수 있도록 하는 통합 로그인 솔루션

- 장점
  - 각 시스템 별로 개별적인 ID/PW 설정이 필요 없음
  - 패스워드 분실/망각 가능성 감소
  - 관리의 간편함, 보안수준의 향상
- 단점
  - SSO서버 침해 시 모든 서버의 보안 침해 가능(단일 실패 지점)
  - 자원별 권한관리 미비

#### 엑스트라넷 접근 관리(EAM, Extranet Access Management)

인트라넷, 엑스트라넷 및 일반 클라이언트/서버 환경에서 자원의 접근 인증과 이를 기반으로 자원에 대한 접근 권한을 부여/관리하는 통합 인증 관리 솔루션

#### 식별/접근 관리(IAM, Identity and Access Management)

ID와 패스워드를 종합적으로 관리해주는 역할 기반의 계정 관리 솔루션. EAM을 확장/보완한 솔루션

### 커버로스(Kerberos)

개방된 네트워크 내에서 서비스 요구를 인증하기 위해 대칭키 암호기법에 바탕을 둔 티켓 기반 인증 프로토콜이자 KDC

- 분산 환경을 위한 SSO
- 기업 접근 통제를 위한 확장성, 투명성, 안정성, 보안을 제공

#### 구성 요소

- KDC
  - 키 분배 서버(Kerberos의 핵심 요소)
- AS
  - 실질적으로 인증을 수행
- TGS
  - 티켓을 부여/분배
- 티켓
  - 사용자에 대해 신원과 인증을 확인하는 토큰

#### 구성도

1. 커버로스는 모든 사용자의 패스워드를 알고 있고, 중앙집중식 DB에 그 패스워드를 저장하고 있는 인증서버(AS)를 이용
2. AS는 각 서버와 유일한 비밀키를 공유
3. TGS는 AS에게 인증 받은 사용자에게 티켓을 발행
4. 사용자가 새 서비스를 요청할 때마다 자신을 인증하는 티켓을 이용하여 TGS에 접속, TGS가 해당 서비스에 대한 티켓 발행
5. 사용자는 서비스 승인 티켓을 보관하고 필요할 때마다 티켓을 사용하여 서버에 인증
6. 타임스탬프로 위장하는 것을 방지

#### 취약점

- 단일 실패 지점
- 비밀키는 사용자의 워크스테이션에 임시저장(공격자에게 탈취 가능성)
- 패스워드 추측 공격에 취약

#### V4 vs V5

- 버전4에서는 DES 알고리즘을 사용해야 했지만 버전5에서는 모든 대칭키 알고리즘을 사용 가능
- 버전4에서는 IP 주소를 사용해야 했지만 버전5에서는 어떤 유형의 네트워크 주소를 사용 가능
- 버전4에서는 티켓 유효기간의 한계가 있었지만 버전5에서는 유효기간의 한계가 없어 수명이 더 길고 갱신도 가능

### 세사미(SESAME)

- 커버로스의 기능을 확장하고 약점을 보완하기 위해 개발된 SSO 기술
- 비대칭 및 대칭키 암호화 기술에 기반
- 티켓이 대신 PAC(Privileged Attribute Certificate)를 사용

보안 모델
---

### 강제적 접근통제(MAC, Mandatory Access Control)

자원의 보안 레벨과 사용자의 보안 취급 인가를 비교하여 접근 제어

- 관리자만이 접근제어의 규칙을 설정, 변경(중앙집중형 보안관리)
- 다중 수준 보안 정책에 기반함(서로 다른 분류 수준의 데이터가 보호되는 방법)
- 벨라파듈라(BLP), 비바 무결성 모델, 클락-윌슨 모델, 만리장성 모델이 대표적

> 모든 MAC 모델은 벨라파듈라(BLP) 모델을 근간으로 함

- 장점
  - 매우 엄격한 보안
  - 모든 객체에 대한 관리가 용이
- 단점
  - 구현, 운영이 복잡
  - 모든 접근에 대해 확인해야 하므로 성능 저하
  - 상업적인 환경에 부적합

#### 벨라파듈라 모델(BLP, Bell-LaPadula Confidentiality Model)

기밀성을 강조하고 수학적 모델에 기반하는 최초의 MAC 모델

**보안 규칙**

|              |  읽기 | 쓰기 | 읽기/쓰기 |
|:------------:|:----:|:---:|:------:|
| 상급 보안 계층  | X | O | X |
| 할당된 보안 계층 | O | O | O |
| 하급 보안 계층  | O | X | X |

- 단순 보안 속성
  - 상향 읽기 X / 하향 읽기 O
- 성형 보안 속성
  - 상향 쓰기 O / 하향 쓰기 X
- 특수 성형 속성
  - 동일 레벨에서만 읽기/쓰기 가능

**장단점**

- 장점
  - 트로이 목마 공격 불가
  - 낮은 단계에서 높은 단계로 가는 기밀성 유지에 강함
- 단점
  - 낮은 단계에서 높은 단계로 글을 쓸 수 있으므로 무결성 유지 어려움
  - 높은 사용자와 낮은 사용자 간 자원 공유 시 기밀성 유지 훼손

#### 비바 무결성 모델(Biba Integrity Model)

BLP를 보완한 무결성 모델(MAC)

- 무결성의 목표 중 비인가자에 의한 부적절한 변조방지만을 목적으로 함

**보안 규칙**

|              |  읽기 | 쓰기 | 읽기/쓰기 |
|:------------:|:----:|:---:|:------:|
| 상급 보안 계층  | O | X | X |
| 할당된 보안 계층 | O | O | O |
| 하급 보안 계층  | X | O | O |

- 단순 무결성 속성
  - 상향 읽기 O / 하향 읽기 X
- 무결성 제한
  - 상향 쓰기 X / 하향 쓰기 O
- 호출 속성
  - 높은 무결성을 가진 주체에게 서비스 요청 X


#### 클락-윌슨 무결성 모델(Clark-Wilson Integrity Model)

조금 더 정교하고 실제적인 무결성 모델

- 무결성의 3가지 목표 제공
  - 비인가자 수정 방지
  - 내/외부 일치성 유지
  - 인가자의 불법적인 수정 방지
- 사용자는 프로그램을 통해서만 객체에 접근
- 상업용

#### 만리장성 모델(Chinese Wall Model)

정보 흐름 모델을 기반으로 주체와 객체 사이에서 이해 충돌을 야기하는 방식으로 정보가 흐르지 않도록 함

- 사용자의 이전 동작에 따라 변화할 수 있는 접근 통제(MAC, DAC)
- 자유 재량과 강제적 접근 개념 모두 이용
- 이해 충동을 방지하기 위해 만리장성이라는 벽 사용


### 임의적 접근통제(DAC, Discretionary Access Control)

주체가 속해있는 그룹의 신원에 근거하여 객체에 대한 접근을 제한하는 방법

- 객체의 소유자가 접근여부를 결정한다. (분산형 보안관리)
- 하나의 주체마다 객체에 대한 접근 권한을 부여해야 함

> 대부분 운영시스템은 이를 기반으로 함

- 장점
  - 객체별 세분화된 접근 제어
  - 특정 주체가 다른 주체에게 임의적인 접근 제어 가능
  - 유연한 접근 제어 서비스
- 단점
  - 시스템 전체 차원의 일관성 있는 접근제어 부족
  - 멀웨어, 바이러스, 웜, 루트 킷, 트로이 목마 등에 취약

#### 접근 제어 행렬(Access Control Matrix)

주체를 행, 객체를 열로 구성하고 해당 셀에 주체가 객체에 수행할 수 있는 접근 권한을 기록하여 관리

- 효과적인 권한 부여 정책을 정의 가능하지만 주체와 객체의 수가 많아질 경우 행렬의 크기가 커져 관리가 어려움
- 비어 있는 셀이 많아지므로 공간적으로 비효율적

#### 자격 목록(Capability List, Capability Tickets)

한 주체가 갖는 자격들의 리스트

- 콘텐츠의 보안성이 보장받지 못하는 분산환경에서 사용
- 커버로스가 자격목록의 한 예

#### 접근제어 목록(ACLs, Access Control Lists)

객체의 관점에서 주체에게 권한을 부여

### 역할기반 접근통제(RBAC, Role-Based Access Control)

주체와 객체 사이에 역할을 두어 역할에 따라 접근통제

- MAC와 DAC의 단점을 보완한 기법이다.
- 주체, 객체에 접근권한을 할당하는 것이 아닌 역할에 접근권한을 할당
- 장점
  - 관리자에게 편리한 관리능력 제공
  - DAC에 비해 유연성은 떨어지나, 일관성 있는 접근제어가 용이
  - 최소권한의 원칙, 직무분리의 원칙 충족 용이

접근통제 보안위협 및 대응책
---

### 패스워드 크래커

- 사전 공격(Dictionary Attack)
  - 패스워드 사전 파일을 이용하여 접속 계정을 알아내는 해킹 방법
  - 공격 대상의 개인 정보를 알고 있다면 효율적
- 무차별 공격(Brute-force Attack)
  - 성공할 때까지 가능한 모든 조합의 경우의 수를 시도해 공격
- 하이브리트 공격
  - 사전 공격과 무차별 공격을 결합하여 공격
- 레인보우 테이블 공격
  - 패스워드를 해시 처리하여 패스워드와 해시로 이루어진 체인을 무수히 만든 테이블을 대입하여 공격
  - 사전 공격, 무차별 공격보다 적은 시간 소요
  - 패스워드에 솔팅 처리를 하여 예방

### 사회공학 공격

신뢰할 수 있는 개인이나 조직을 사칭하여 공격대상의 민감한 정보를 빼내는 공격 기법

- 피싱(Phishing)
  - 공격 대상에게 E-mail 을 발송하여 위조된 사이트로 이동시킨 후, 개인 정보를 요구
- 파밍(Pharming)
  - 정상적인 사이트로의 접속 요청을 위조 사이트로 바꾸어 개인정보 탈취
- 스미싱(SMishing)
  - SMS+Phishing
  - SMS을 통해 사용자를 속여 악성 소프트웨어 설치를 유도
  - 해당 소프트웨어를 통해 개인정보를 탈취하거나 금전을 요구
- 은닉채널(Covert Channel)
  - 개체가 허가되지 않은 방식으로 정보를 얻는 방법
  - 정보흐름은 은닉채널이 존재하지 않게 설정해야 함
- 방사(Emanation)
  - 컴퓨터와 장치로부터 방출되는 전기적 신호를 가로채는 방법
  - 탬페스트로 방사 신호를 억제하거나 백색소음을 의도적으로 방출해서 예방
